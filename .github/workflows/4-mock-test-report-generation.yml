name: 'Mock Test Report Generation from Variables'

on: workflow_dispatch

jobs:
  test-report-with-mock-data:
    runs-on: ubuntu-latest
    steps:
      - name: 'Checkout code'
        uses: actions/checkout@v6

      - name: 'Generate mock data from Repository Variables'
        # Hier werden die Repository-Variablen aus dem `vars`-Kontext gelesen
        # und als Umgebungsvariablen f√ºr das Skript bereitgestellt.
        env:
          MOCK_NUM_DISKS: ${{ vars.MOCK_NUM_DISKS }}
          MOCK_NUM_IPS: ${{ vars.MOCK_NUM_IPS }}
          MOCK_NUM_SNAPSHOTS: ${{ vars.MOCK_NUM_SNAPSHOTS }}
          MOCK_NUM_ADVISOR_HA: ${{ vars.MOCK_NUM_ADVISOR_HA }}
          MOCK_NUM_ADVISOR_COST: ${{ vars.MOCK_NUM_ADVISOR_COST }}
        run: |
          chmod +x .github/scripts/create-mock-data.sh
          .github/scripts/create-mock-data.sh

      - name: 'Generate report from mock data'
        run: |
          chmod +x .github/scripts/generate-report.sh
          .github/scripts/generate-report.sh

      - name: 'Upload test report'
        uses: actions/upload-artifact@v4
        with:
          name: test-report-from-variables
          path: report.md
