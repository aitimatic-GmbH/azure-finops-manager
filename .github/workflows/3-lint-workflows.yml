# .github/workflows/lint-workflows.yml

name: 'Lint Workflow Files'

# ====================================================================
# TRIGGER: Wann soll dieser Workflow laufen?
# ====================================================================
on:
  # Läuft bei jedem Push auf einen Branch (außer main, um Doppel-Ausführungen zu vermeiden)
  push:
    branches-ignore:
      - main

  # WICHTIGSTER TRIGGER: Läuft bei jedem Pull Request, der auf 'main' zielt.
  # Das ist unser Quality Gate.
  pull_request:
    branches:
      - main

  # Ermöglicht manuellen Start für Testzwecke
  workflow_dispatch:

# ====================================================================
# JOB: Der eigentliche Linting-Prozess
# ====================================================================
jobs:
  lint-workflows:
    name: 'Validate Workflow Syntax with actionlint'
    runs-on: ubuntu-latest

    steps:
      # Schritt 1: Code auschecken, damit der Linter die Dateien findet
      - name: 'Checkout repository'
        uses: actions/checkout@v6

      # Schritt 2: actionlint herunterladen und installieren
      # Wir verwenden hier den offiziellen "setup-actionlint" Workflow für Einfachheit.
      # Alternativ könnte man den Einzeiler von vorhin nutzen.
      - name: 'Install actionlint'
        id: get_actionlint
        run: bash <(curl https://raw.githubusercontent.com/rhysd/actionlint/main/scripts/download-actionlint.bash)
        shell: bash

      # Schritt 3: actionlint ausführen
      # Dieser Schritt schlägt fehl, wenn actionlint Fehler findet, und blockiert so den PR.
      - name: 'Check workflow files'
        run: ${{ steps.get_actionlint.outputs.executable }} -color
        shell: bash

